---
layout: feature
title: Dedicated Thread Pool
prev_slug: delayed-jobs
prev_text: Delayed jobs
next_slug: multiple-servers
next_text: Multiple servers
---

Для обработки задач используется собственный пул потоков, строго ограниченный по количеству рабочих потоков. Использование собственного пула потоков было выбрано по тем соображением, что сервер никогда не знает, сколько задач находится в очереди. Чтение очередной задачи должно быть выполнено внутри отдельного потока для достижения большей эффективности. И тут встает проблема, сколько потоков нужно создать, когда неизвестно общее количество задач.

Количество потоков по-умолчанию равно `Environment.ProcessorCount * 5`. Это число не сильно большое для CPU-intensive задач, что не убивает процессор постоянными переключениями контекста, и не слишком маленькое для I/O-intensive задач, при котором задачи все-равно более или менее эффективно выполняются при ожиданиях завершения операции ввода-вывода.

Вы можете оптимизировать число рабочих потоков для вашего случая, подобрав их количество экспериментальным путем. Для этого нужно передать их число при создании экземпляра `BackgroundJobServer` (или `AspNetBackgroundJobServer`):

```csharp
var workerCount = 500;
var server = new BackgroundJobServer(workerCount);
server.Start();
```